<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Netflix Title Search</title>

    <!-- link to css, load static required for proper styling in django -->
    {% load static %}
    <link rel="stylesheet" href="{% static 'searchApp/css/search.css' %}">

</head>
<body>
    <form method="GET"> <!-- Form that uses GET to grab data from user and the CSV -->
        <a class="graphs-link" href="{% url 'graphs' %}">Go to graphs</a>

        <input type="text" id="title" name="title" placeholder="Search by Title" value="{{title}}">
        <input type="text" id="director" name="director" placeholder="Search by Director" value="{{director}}">
        <input type="text" id="cast" name="cast" placeholder="Search by Cast" value="{{cast}}">

        <!-- Dropdown for the release year filter -->
        <label for="release_year">Release Year:</label>
        <select name="release_year" id="release_year">
            <option value="">--Select Year--</option>
            <!-- Loops through the available years (y) and creates options based on dataset -->
            {% for y in years %}
                <option value="{{y}}">{{y}}</option>
            {% endfor %}
        </select><br>

        <h3>Genres</h3>
        <div class="checkbox-group genre-group">
            {% for g in genre %}
                <label class="checkbox-label">
                    <!-- Generates a checkbox for each genre -->
                    <input type="checkbox" id="{{g}}" name="genres" value="{{g}}">
                    {{g}}
                </label>
            {% endfor %}
        </div>

        <h3>Countries</h3>
        <div class="checkbox-group">
            {% for c in country %}
                {% if c %}
                    <label class="checkbox-label">
                        <!-- Generates a checkbox for each country -->
                        <input type="checkbox" id="{{c}}" name="countries" value="{{c}}">
                        {{c}}
                    </label>
                {% endif %}
            {% endfor %}
        </div>

        <br>
        <button type="submit">Search</button>
    </form>

    <!-- Displays the available titles in the dataset based on the chosen filters -->
    <h2>Search Results:</h2>
    <div class="results">
        {% for r in results %}
            <p>{{r}}</p>
        {% endfor %}
    </div>

    <script>
        // Save scroll position before leaving/reloading the page
        window.addEventListener("beforeunload", function () {
            localStorage.setItem("scrollPos", window.scrollY);
        });

        // Restore scroll position on page load (useful for search)
        window.addEventListener("load", function () {
            const scrollPos = localStorage.getItem("scrollPos");
            if (scrollPos) {
            window.scrollTo(0, scrollPos);
            localStorage.removeItem("scrollPos");
            }
        });
    </script>
</body>
</html>